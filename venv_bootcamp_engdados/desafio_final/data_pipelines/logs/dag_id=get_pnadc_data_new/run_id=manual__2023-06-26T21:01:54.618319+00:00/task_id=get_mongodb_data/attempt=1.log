[2023-06-26T21:02:09.264+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: get_pnadc_data_new.get_mongodb_data manual__2023-06-26T21:01:54.618319+00:00 [queued]>
[2023-06-26T21:02:09.322+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: get_pnadc_data_new.get_mongodb_data manual__2023-06-26T21:01:54.618319+00:00 [queued]>
[2023-06-26T21:02:09.322+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2023-06-26T21:02:09.322+0000] {taskinstance.py:1363} INFO - Starting attempt 1 of 1
[2023-06-26T21:02:09.322+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2023-06-26T21:02:09.385+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): get_mongodb_data> on 2023-06-26 21:01:54.618319+00:00
[2023-06-26T21:02:09.407+0000] {standard_task_runner.py:55} INFO - Started process 240 to run task
[2023-06-26T21:02:09.415+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'get_pnadc_data_new', 'get_mongodb_data', 'manual__2023-06-26T21:01:54.618319+00:00', '--job-id', '40', '--raw', '--subdir', 'DAGS_FOLDER/get_pnadc_data_new.py', '--cfg-path', '/tmp/tmpf9fb4n99']
[2023-06-26T21:02:09.418+0000] {standard_task_runner.py:83} INFO - Job 40: Subtask get_mongodb_data
[2023-06-26T21:02:09.559+0000] {task_command.py:376} INFO - Running <TaskInstance: get_pnadc_data_new.get_mongodb_data manual__2023-06-26T21:01:54.618319+00:00 [running]> on host f5a823219759
[2023-06-26T21:02:09.879+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=get_pnadc_data_new
AIRFLOW_CTX_TASK_ID=get_mongodb_data
AIRFLOW_CTX_EXECUTION_DATE=2023-06-26T21:01:54.618319+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-06-26T21:01:54.618319+00:00
[2023-06-26T21:02:09.919+0000] {base.py:71} INFO - Using connection ID 'mongodb_conn' for task execution.
[2023-06-26T21:02:13.186+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 193, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/scripts/extract.py", line 14, in _get_mongodb_data
    for d in raw_data:
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/cursor.py", line 1251, in next
    if len(self.__data) or self._refresh():
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/cursor.py", line 1168, in _refresh
    self.__send_message(q)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/cursor.py", line 1056, in __send_message
    operation, self._unpack_response, address=self.__address
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 106, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1346, in _run_operation
    retryable=isinstance(operation, message._Query),
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/_csot.py", line 106, in csot_wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1459, in _retryable_read
    with self._socket_from_server(read_pref, server, session) as (sock_info, read_pref):
  File "/usr/local/lib/python3.7/contextlib.py", line 112, in __enter__
    return next(self.gen)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1293, in _socket_from_server
    with self._get_socket(server, session) as sock_info:
  File "/usr/local/lib/python3.7/contextlib.py", line 112, in __enter__
    return next(self.gen)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/mongo_client.py", line 1228, in _get_socket
    with server.get_socket(handler=err_handler) as sock_info:
  File "/usr/local/lib/python3.7/contextlib.py", line 112, in __enter__
    return next(self.gen)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/pool.py", line 1522, in get_socket
    sock_info = self._get_socket(handler=handler)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/pool.py", line 1635, in _get_socket
    sock_info = self.connect(handler=handler)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/pool.py", line 1493, in connect
    sock_info.authenticate()
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/pool.py", line 987, in authenticate
    auth.authenticate(creds, self, reauthenticate=reauthenticate)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/auth.py", line 617, in authenticate
    auth_func(credentials, sock_info)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/auth.py", line 522, in _authenticate_default
    return _authenticate_scram(credentials, sock_info, "SCRAM-SHA-1")
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/auth.py", line 248, in _authenticate_scram
    res = sock_info.command(source, cmd)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/helpers.py", line 279, in inner
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/pool.py", line 901, in command
    write_concern=write_concern,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/network.py", line 170, in command
    parse_write_concern_error=parse_write_concern_error,
  File "/home/airflow/.local/lib/python3.7/site-packages/pymongo/helpers.py", line 194, in _check_command_response
    raise OperationFailure(errmsg, code, response, max_wire_version)
pymongo.errors.OperationFailure: bad auth : Authentication failed., full error: {'ok': 0, 'errmsg': 'bad auth : Authentication failed.', 'code': 8000, 'codeName': 'AtlasError'}
[2023-06-26T21:02:13.388+0000] {taskinstance.py:1406} INFO - Marking task as FAILED. dag_id=get_pnadc_data_new, task_id=get_mongodb_data, execution_date=20230626T210154, start_date=20230626T210209, end_date=20230626T210213
[2023-06-26T21:02:13.527+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 40 for task get_mongodb_data (bad auth : Authentication failed., full error: {'ok': 0, 'errmsg': 'bad auth : Authentication failed.', 'code': 8000, 'codeName': 'AtlasError'}; 240)
[2023-06-26T21:02:13.587+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2023-06-26T21:02:13.651+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
